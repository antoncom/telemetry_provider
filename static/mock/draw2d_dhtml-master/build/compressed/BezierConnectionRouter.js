/**
This notice must be untouched at all times.
This is the COMPRESSED version of Draw2D
WebSite: http://www.draw2d.org
Copyright: 2006 Andreas Herz. All rights reserved.
Created: 5.11.2006 by Andreas Herz (Web: http://www.freegroup.de )
LICENSE: LGPL
**/

draw2d.BezierConnectionRouter=function(_3cd){if(!_3cd){this.cheapRouter=new draw2d.ManhattanConnectionRouter();}else{this.cheapRouter=null;}this.iteration=5;};draw2d.BezierConnectionRouter.prototype=new draw2d.ConnectionRouter();draw2d.BezierConnectionRouter.prototype.type="draw2d.BezierConnectionRouter";draw2d.BezierConnectionRouter.prototype.drawBezier=function(_3ce,_3cf,t,iter){var n=_3ce.length-1;var q=[];var _3d4=n+1;for(var i=0;i<_3d4;i++){q[i]=[];q[i][0]=_3ce[i];}for(var j=1;j<=n;j++){for(var i=0;i<=(n-j);i++){q[i][j]=new draw2d.Point((1-t)*q[i][j-1].x+t*q[i+1][j-1].x,(1-t)*q[i][j-1].y+t*q[i+1][j-1].y);}}var c1=[];var c2=[];for(var i=0;i<n+1;i++){c1[i]=q[0][i];c2[i]=q[i][n-i];}if(iter>=0){this.drawBezier(c1,_3cf,t,--iter);this.drawBezier(c2,_3cf,t,--iter);}else{for(var i=0;i<n;i++){_3cf.push(q[i][n-i]);}}};draw2d.BezierConnectionRouter.prototype.route=function(conn){if(this.cheapRouter!==null&&(conn.getSource().getParent().isMoving===true||conn.getTarget().getParent().isMoving===true)){this.cheapRouter.route(conn);return;}var _3da=[];var _3db=conn.getStartPoint();var toPt=conn.getEndPoint();this._route(_3da,conn,toPt,this.getEndDirection(conn),_3db,this.getStartDirection(conn));var _3dd=[];this.drawBezier(_3da,_3dd,0.5,this.iteration);for(var i=0;i<_3dd.length;i++){conn.addPoint(_3dd[i]);}conn.addPoint(toPt);};draw2d.BezierConnectionRouter.prototype._route=function(_3df,conn,_3e1,_3e2,toPt,_3e4){var TOL=0.1;var _3e6=0.01;var _3e7=90;var UP=0;var _3e9=1;var DOWN=2;var LEFT=3;var _3ec=_3e1.x-toPt.x;var _3ed=_3e1.y-toPt.y;var _3ee;var dir;if(((_3ec*_3ec)<(_3e6))&&((_3ed*_3ed)<(_3e6))){_3df.push(new draw2d.Point(toPt.x,toPt.y));return;}if(_3e2===LEFT){if((_3ec>0)&&((_3ed*_3ed)<TOL)&&(_3e4===_3e9)){_3ee=toPt;dir=_3e4;}else{if(_3ec<0){_3ee=new draw2d.Point(_3e1.x-_3e7,_3e1.y);}else{if(((_3ed>0)&&(_3e4===DOWN))||((_3ed<0)&&(_3e4===UP))){_3ee=new draw2d.Point(toPt.x,_3e1.y);}else{if(_3e2===_3e4){var pos=Math.min(_3e1.x,toPt.x)-_3e7;_3ee=new draw2d.Point(pos,_3e1.y);}else{_3ee=new draw2d.Point(_3e1.x-(_3ec/2),_3e1.y);}}}if(_3ed>0){dir=UP;}else{dir=DOWN;}}}else{if(_3e2===_3e9){if((_3ec<0)&&((_3ed*_3ed)<TOL)&&(_3e4==LEFT)){_3ee=toPt;dir=_3e4;}else{if(_3ec>0){_3ee=new draw2d.Point(_3e1.x+_3e7,_3e1.y);}else{if(((_3ed>0)&&(_3e4===DOWN))||((_3ed<0)&&(_3e4===UP))){_3ee=new draw2d.Point(toPt.x,_3e1.y);}else{if(_3e2===_3e4){var pos=Math.max(_3e1.x,toPt.x)+_3e7;_3ee=new draw2d.Point(pos,_3e1.y);}else{_3ee=new draw2d.Point(_3e1.x-(_3ec/2),_3e1.y);}}}if(_3ed>0){dir=UP;}else{dir=DOWN;}}}else{if(_3e2===DOWN){if(((_3ec*_3ec)<TOL)&&(_3ed<0)&&(_3e4===UP)){_3ee=toPt;dir=_3e4;}else{if(_3ed>0){_3ee=new draw2d.Point(_3e1.x,_3e1.y+_3e7);}else{if(((_3ec>0)&&(_3e4===_3e9))||((_3ec<0)&&(_3e4===LEFT))){_3ee=new draw2d.Point(_3e1.x,toPt.y);}else{if(_3e2===_3e4){var pos=Math.max(_3e1.y,toPt.y)+_3e7;_3ee=new draw2d.Point(_3e1.x,pos);}else{_3ee=new draw2d.Point(_3e1.x,_3e1.y-(_3ed/2));}}}if(_3ec>0){dir=LEFT;}else{dir=_3e9;}}}else{if(_3e2===UP){if(((_3ec*_3ec)<TOL)&&(_3ed>0)&&(_3e4===DOWN)){_3ee=toPt;dir=_3e4;}else{if(_3ed<0){_3ee=new draw2d.Point(_3e1.x,_3e1.y-_3e7);}else{if(((_3ec>0)&&(_3e4===_3e9))||((_3ec<0)&&(_3e4===LEFT))){_3ee=new draw2d.Point(_3e1.x,toPt.y);}else{if(_3e2===_3e4){var pos=Math.min(_3e1.y,toPt.y)-_3e7;_3ee=new draw2d.Point(_3e1.x,pos);}else{_3ee=new draw2d.Point(_3e1.x,_3e1.y-(_3ed/2));}}}if(_3ec>0){dir=LEFT;}else{dir=_3e9;}}}}}}this._route(_3df,conn,_3ee,dir,toPt,_3e4);_3df.push(_3e1);};